<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Grand Jeu Chandeleur</title>
  <link rel="stylesheet" href="admin.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="admin-container">
    
    <!-- HEADER -->
    <div class="admin-header">
      <h1>ğŸ¯ Admin - Grand Jeu Chandeleur</h1>
      <p class="subtitle">AccÃ¨s rÃ©servÃ© admin (token stockÃ© en local).</p>
      <button class="logout-btn" onclick="logout()">ğŸšª DÃ©connexion</button>
    </div>

    <!-- SECTION CONNEXION -->
    <div id="loginSection" class="section">
      <h2>Connexion</h2>
      <form onsubmit="login(event)">
        <div style="margin-bottom: 15px;">
          <label style="display: block; margin-bottom: 5px;">Identifiant</label>
          <input type="text" id="username" required style="width: 100%; padding: 10px; border-radius: 8px; border: 2px solid var(--admin-border); background: var(--admin-dark); color: var(--admin-light);">
        </div>
        <div style="margin-bottom: 15px;">
          <label style="display: block; margin-bottom: 5px;">Mot de passe</label>
          <input type="password" id="password" required style="width: 100%; padding: 10px; border-radius: 8px; border: 2px solid var(--admin-border); background: var(--admin-dark); color: var(--admin-light);">
        </div>
        <button type="submit" class="btn">Se connecter</button>
      </form>
    </div>

    <!-- SECTION INSCRITS -->
    <div id="participantsSection" class="section" style="display: none;">
      <h2>Inscrits</h2>
      <p>Liste des participants enregistrÃ©s.</p>

      <div style="margin: 20px 0;">
        <button class="btn" onclick="exportCSV()">Exporter CSV</button>
        <button class="btn btn-secondary" onclick="deleteSelected()">Supprimer sÃ©lection</button>
      </div>

      <!-- FILTRES -->
      <div class="filters">
        <input type="text" id="searchField" placeholder="Rechercher (nom, prÃ©nom, email, magasin...)" style="flex: 1; min-width: 250px;">
        
        <select id="enseigneField">
          <option value="">Toutes enseignes</option>
          <option value="ambiance-styles">Ambiance & Styles</option>
          <option value="culinarion">Culinarion</option>
        </select>
        
        <select id="optinField">
          <option value="">Opt-in (tous)</option>
          <option value="true">Opt-in uniquement</option>
          <option value="false">Sans opt-in</option>
        </select>
        
        <select id="sortField">
          <option value="created_at">Date (rÃ©cent â†’ ancien)</option>
          <option value="nom">Nom</option>
          <option value="email">Email</option>
        </select>
      </div>

      <!-- TABLE -->
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th><input type="checkbox" id="selectAll" onchange="toggleSelectAll()"></th>
              <th>DATE</th>
              <th>NOM</th>
              <th>PRÃ‰NOM</th>
              <th>EMAIL</th>
              <th>ENSEIGNE</th>
              <th>OPT-IN</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>

      <!-- PAGINATION -->
      <div class="pagination">
        <button id="prevBtn" onclick="goToPrevPage()">â—€ PrÃ©cÃ©dent</button>
        <span id="pageIndicator">Page 1</span>
        <button id="nextBtn" onclick="goToNextPage()">Suivant â–¶</button>
      </div>
    </div>

    <!-- SECTION STATS -->
    <div id="statsSection" class="section" style="display: none;">
      <h2>Stats</h2>
      <p>Ã€ brancher ensuite.</p>
      <p>Ã€ venir.</p>
    </div>

    <!-- SECTION TESTS -->
    <div id="testsSection" class="section" style="display: none;">
      <h2>Tests</h2>
      <p>AccÃ¨s rapide aux Ã©crans du jeu pour tester/dÃ©bugger.</p>

      <div style="margin-top: 20px;">
        <h3>ğŸª Ambiance & Styles</h3>
        <a class="btn" href="/ambiance-styles/?goto=menu" target="_blank">Ouvrir le jeu (menu)</a>
        <a class="btn" href="/ambiance-styles/?goto=level1" target="_blank">Jeu 1 (Memory)</a>
        <a class="btn" href="/ambiance-styles/?goto=level2" target="_blank">Jeu 2 (Mots)</a>
        <a class="btn" href="/ambiance-styles/?goto=level3" target="_blank">Jeu 3 (Quiz)</a>
        <a class="btn btn-secondary" href="/ambiance-styles/?goto=all_done_form" target="_blank">Formulaire</a>
      </div>

      <div style="margin-top: 20px;">
        <h3>ğŸ´ Culinarion</h3>
        <a class="btn" href="/culinarion/?goto=menu" target="_blank">Ouvrir le jeu (menu)</a>
        <a class="btn" href="/culinarion/?goto=level1" target="_blank">Jeu 1 (Memory)</a>
        <a class="btn" href="/culinarion/?goto=level2" target="_blank">Jeu 2 (Mots)</a>
        <a class="btn" href="/culinarion/?goto=level3" target="_blank">Jeu 3 (Quiz)</a>
        <a class="btn btn-secondary" href="/culinarion/?goto=all_done_form" target="_blank">Formulaire</a>
      </div>

      <p style="margin-top: 20px; color: var(--admin-gray); font-size: 0.9rem;">
        <strong>Note :</strong> pour que ces liens ouvrent directement les bons Ã©crans, il faut ajouter un mini "routeur" dans 
        <code>ambiance-styles/script.js</code> (je te donne le snippet juste aprÃ¨s).
      </p>
    </div>

  </div>

  <script src="admin.js"></script>
</body>
</html>
